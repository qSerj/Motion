# ADR 001: Архитектура Timeline Control

* Статус: Принято
* Дата: 2026-01-27

## Контекст
Нам необходимо реализовать визуальный редактор уровней (Timeline) в Avalonia UI. Требуется высокая производительность при отрисовке множества событий и поддержка масштабирования (Zoom).

## Решение
Мы используем подход MVVM с вложенными `ItemsControl` и абсолютным позиционированием через `Canvas`.

1. **ViewModel Layer:**
   - `TimelineEditorViewModel` управляет масштабом (`PixelsPerSecond`) и позицией курсора.
   - События (`TimelineEventViewModel`) сами пересчитывают свои координаты (`XPixels`, `WidthPixels`) при изменении масштаба.

2. **View Layer:**
   - Используем `ItemsControl` с `Canvas` в качестве панели.
   - Для повышения производительности и предотвращения крашей при инициализации используем `x:CompileBindings="False"` точечно в стилях позиционирования (`Canvas.Left`).
   - Виртуализация UI пока отключена (так как элементов < 1000).

## Последствия
- **Плюсы:** Полный контроль над позиционированием, легкая анимация зума.
- **Минусы:** Нужно вручную синхронизировать скролл заголовков и дорожек (через Grid layout).